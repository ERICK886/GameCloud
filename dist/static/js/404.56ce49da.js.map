{"version":3,"file":"static/js/404.56ce49da.js","mappings":"0/BAMA,MAAMA,GAASC,EAAAA,EAAAA,MACTC,GAAUC,EAAAA,EAAAA,KACVC,GAAUC,EAAAA,EAAAA,IAAS,CACvBC,QAAS,EACTC,OAAQ,CACN,UACA,UACA,WAEFC,IAAK,GACLC,gBAAgB,IAEZC,EAAkBA,MACtBC,EAAAA,EAAAA,MAAcC,MAAKC,IACK,MAAlBA,EAAIC,KAAKC,MACPF,EAAIC,KAAKA,KACXd,EAAOgB,KAAK,CAACC,KAAM,SAKrBjB,EAAOgB,KAAK,CAACC,KAAM,WACrB,IACCC,OAAMC,IACPnB,EAAOgB,KAAK,CAACC,KAAM,WAAW,GAC9B,EAEJP,IAEA,MAAMI,GAAOT,EAAAA,EAAAA,IAAS,CACpBe,MAAO,CACLC,KAAM,YACNC,KAAM,OACNC,SAAU,WACVC,KAAM,OACNC,SAAU,QAEZC,KAAM,CACJT,KAAM,WACNU,KAAM,oBACNC,SAAU,mBACVC,OAAQ,8BAEVC,MAAO,CACLC,SAAU,QACVN,SAAU,SACVO,SAAU,MACVC,MAAO,uBAILC,EAAeA,KACnB9B,EAAQK,gBAAiB,EACD,KAApBK,EAAKM,MAAMC,KAIS,KAApBP,EAAKM,MAAME,KAIa,KAAxBR,EAAKM,MAAMG,SAIS,KAApBT,EAAKM,MAAMI,KAIa,KAAxBV,EAAKM,MAAMK,SAKQ,KAAnBX,EAAKY,KAAKT,KAIS,KAAnBH,EAAKY,KAAKC,KAIW,KAArBb,EAAKY,KAAKG,OAIc,KAAxBf,EAAKgB,MAAMC,SAIa,KAAxBjB,EAAKgB,MAAME,SAIa,KAAxBlB,EAAKgB,MAAML,SAIU,KAArBX,EAAKgB,MAAMG,OAIfE,KACAC,EAAAA,EAAAA,IAAmBtB,GAAMF,MAAKC,IACN,MAAlBA,EAAIC,KAAKC,MACXX,EAAQG,OAAOH,EAAQE,SAAW,SAClCF,EAAQI,IAAMK,EAAIC,KAAKA,KAAKN,IAC5BN,EAAQmC,QAAQ,QAChBjC,EAAQK,gBAAiB,IAEzBL,EAAQG,OAAOH,EAAQE,SAAW,QAClCF,EAAQI,IAAMK,EAAIC,KAAKA,KAAKN,IAC5BJ,EAAQK,gBAAiB,EAC3B,IACCS,OAAMC,IACPjB,EAAQoC,MAAMnB,EAAIjB,QAAQ,KAhB1BA,EAAQoC,MAAM,aAJdpC,EAAQoC,MAAM,aAJdpC,EAAQoC,MAAM,aAJdpC,EAAQoC,MAAM,cAJdpC,EAAQoC,MAAM,YAJdpC,EAAQoC,MAAM,YAJdpC,EAAQoC,MAAM,YALdpC,EAAQoC,MAAM,aAJdpC,EAAQoC,MAAM,cAJdpC,EAAQoC,MAAM,aAJdpC,EAAQoC,MAAM,aAJdpC,EAAQoC,MAAM,YA8Dd,EAGEH,EAAOA,KACX/B,EAAQG,OAAOH,EAAQE,SAAW,SAClCF,EAAQE,UACRF,EAAQG,OAAOH,EAAQE,SAAW,UAClCF,EAAQI,IAAM,EAAE,EAGZ+B,EAAOA,KACXnC,EAAQG,OAAOH,EAAQE,SAAW,OAClCF,EAAQE,UACRF,EAAQG,OAAOH,EAAQE,SAAW,UAClCF,EAAQI,IAAM,EAAE,EAEZgC,GAAaC,EAAAA,EAAAA,IAAI,M,OACvBC,EAAAA,EAAAA,KAAU,MACRC,EAAAA,EAAAA,KAAY,KACNvC,EAAQI,MACVoC,EAAAA,EAAAA,KAAS,KACPJ,EAAWK,OAAOC,SAAS,CAACC,SAAU,SAAUC,QAAQ,GAAM,GAElE,GACA,I,k6MC5IJ,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://frontend/./src/views/Install/Install.vue","webpack://frontend/./src/views/Install/Install.vue?3fa6"],"sourcesContent":["<script setup>\r\nimport {nextTick, onMounted, ref, reactive, watchEffect} from 'vue';\r\nimport {useMessage} from 'naive-ui'\r\nimport {configCheck, systemStartInstall} from \"@/assets/js/api\";\r\nimport {useRouter} from 'vue-router'\r\n\r\nconst router = useRouter()\r\nconst message = useMessage()\r\nconst install = reactive({\r\n  current: 0,\r\n  status: [\r\n    'process',\r\n    'process',\r\n    'process',\r\n  ],\r\n  log: '',\r\n  installLoading: false,\r\n})\r\nconst checkConfigData = () => {\r\n  configCheck().then(res => {\r\n    if (res.data.code === 200) {\r\n      if (res.data.data) {\r\n        router.push({name: 'home'})\r\n      } else {\r\n        router.push({name: 'install'})\r\n      }\r\n    } else {\r\n      router.push({name: 'install'})\r\n    }\r\n  }).catch(err => {\r\n    router.push({name: 'install'})\r\n  })\r\n}\r\ncheckConfigData()\r\n\r\nconst data = reactive({\r\n  mysql: {\r\n    host: '127.0.0.1',\r\n    port: '3306',\r\n    database: 'database',\r\n    user: 'root',\r\n    password: 'root'\r\n  },\r\n  site: {\r\n    name: '小技资源分享系统',\r\n    desc: '基于Python开发的资源分享系统',\r\n    keywords: 'Python,Vue,MySQL',\r\n    domain: 'https://example.domain.com',\r\n  },\r\n  admin: {\r\n    username: 'admin',\r\n    password: '000000',\r\n    nickname: '管理员',\r\n    email: 'admin@example.com'\r\n  }\r\n})\r\n\r\nconst startInstall = () => {\r\n  install.installLoading = true\r\n  if (data.mysql.host === \"\") {\r\n    message.error('数据库地址不能为空')\r\n    return\r\n  }\r\n  if (data.mysql.port === \"\") {\r\n    message.error('数据库端口不能为空')\r\n    return\r\n  }\r\n  if (data.mysql.database === \"\") {\r\n    message.error('数据库名称不能为空')\r\n    return\r\n  }\r\n  if (data.mysql.user === \"\") {\r\n    message.error('数据库用户名不能为空')\r\n    return\r\n  }\r\n  if (data.mysql.password === \"\") {\r\n    message.error('数据库密码不能为空')\r\n    return\r\n  }\r\n\r\n  if (data.site.name === \"\") {\r\n    message.error('网站名称不能为空')\r\n    return\r\n  }\r\n  if (data.site.desc === \"\") {\r\n    message.error('网站描述不能为空')\r\n    return\r\n  }\r\n  if (data.site.domain === \"\") {\r\n    message.error('网站域名不能为空')\r\n    return\r\n  }\r\n  if (data.admin.username === \"\") {\r\n    message.error('管理员用户名不能为空')\r\n    return\r\n  }\r\n  if (data.admin.nickname === \"\") {\r\n    message.error('管理员昵称不能为空')\r\n    return\r\n  }\r\n  if (data.admin.password === \"\") {\r\n    message.error('管理员密码不能为空')\r\n    return\r\n  }\r\n  if (data.admin.email === \"\") {\r\n    message.error('管理员邮箱不能为空')\r\n    return\r\n  }\r\n  next()\r\n  systemStartInstall(data).then(res => {\r\n    if (res.data.code === 200) {\r\n      install.status[install.current] = 'finish'\r\n      install.log = res.data.data.log\r\n      message.success('安装成功')\r\n      install.installLoading = false\r\n    } else {\r\n      install.status[install.current] = 'error'\r\n      install.log = res.data.data.log\r\n      install.installLoading = false\r\n    }\r\n  }).catch(err => {\r\n    message.error(err.message)\r\n  })\r\n}\r\n\r\nconst next = () => {\r\n  install.status[install.current] = 'finish'\r\n  install.current++\r\n  install.status[install.current] = 'process'\r\n  install.log = ''\r\n}\r\n\r\nconst prev = () => {\r\n  install.status[install.current] = 'wait'\r\n  install.current--\r\n  install.status[install.current] = 'process'\r\n  install.log = ''\r\n}\r\nconst logInstRef = ref(null);\r\nonMounted(() => {\r\n  watchEffect(() => {\r\n    if (install.log) {\r\n      nextTick(() => {\r\n        logInstRef.value?.scrollTo({position: \"bottom\", silent: true});\r\n      });\r\n    }\r\n  })\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"install-container\">\r\n    <n-card class=\"install-panel\">\r\n      <n-h2 prefix=\"bar\" type=\"success\">安装向导</n-h2>\r\n      <n-text class=\"install-content\">欢迎使用小技资源分享系统</n-text>\r\n      <n-divider/>\r\n      <div v-if=\"install.current === 0\" class=\"install-content\">\r\n        <n-h3 prefix=\"bar\" type=\"success\">项目信息</n-h3>\r\n        <n-descriptions :columns=\"2\" bordered label-placement=\"left\" label-style=\"width: 20%\">\r\n          <n-descriptions-item label=\"项目名称\">小技资源分享系统</n-descriptions-item>\r\n          <n-descriptions-item label=\"项目版本\">1.0.0</n-descriptions-item>\r\n          <n-descriptions-item label=\"项目作者\">可口可乐（Erick Lee）</n-descriptions-item>\r\n          <n-descriptions-item label=\"项目描述\">基于Python开发的资源分享系统</n-descriptions-item>\r\n          <n-descriptions-item label=\"项目地址\">\r\n            <div style=\"display: flex;align-items: center\">\r\n              <i class=\"fa-brands fa-github\" style=\"margin-right: 8px\"></i>\r\n              <n-a href=\"https://github.com/ERICK886/JeesResource\">https://github.com/ERICK886/JeesResource</n-a>\r\n            </div>\r\n          </n-descriptions-item>\r\n        </n-descriptions>\r\n        <div class=\"install-content\" style=\"display: flex;align-items: center;justify-content: flex-end\">\r\n          <n-button type=\"primary\" @click=\"next\">下一步</n-button>\r\n        </div>\r\n      </div>\r\n      <div v-if=\"install.current !== 0\" class=\"install-steps\">\r\n        <n-steps :current=\"install.current\" :status=\"install.status[install.current]\">\r\n          <n-step description=\"填写配置信息用于安装系统\" title=\"配置\"/>\r\n          <n-step description=\"根据配置安装系统\" title=\"安装\"/>\r\n          <n-step description=\"安装完成\" title=\"完成\"/>\r\n        </n-steps>\r\n      </div>\r\n      <div v-if=\"install.current === 1\">\r\n        <n-h3 prefix=\"bar\" type=\"success\">数据库配置</n-h3>\r\n        <n-text class=\"install-content\">请选择谨慎配置数据库，否则会导致数据异常</n-text>\r\n        <n-h5 prefix=\"bar\" type=\"success\">MySQL配置</n-h5>\r\n        <div class=\"install-content\">\r\n          <n-form class=\"install-form\" label-placement=\"top\" label-width=\"auto\">\r\n            <n-form-item label=\"数据库地址\">\r\n              <n-input v-model:value=\"data.mysql.host\" placeholder=\"请输入数据库地址\"/>\r\n            </n-form-item>\r\n            <n-form-item label=\"数据库端口\">\r\n              <n-input v-model:value=\"data.mysql.port\" placeholder=\"请输入数据库端口\"/>\r\n            </n-form-item>\r\n            <n-form-item label=\"数据库名称\">\r\n              <n-input v-model:value=\"data.mysql.database\" placeholder=\"请输入数据库名称\"/>\r\n            </n-form-item>\r\n            <n-form-item label=\"数据库用户名\">\r\n              <n-input v-model:value=\"data.mysql.user\" placeholder=\"请输入数据库用户名\"/>\r\n            </n-form-item>\r\n            <n-form-item label=\"数据库密码\">\r\n              <n-input v-model:value=\"data.mysql.password\" placeholder=\"请输入数据库密码\" show-password-on=\"click\"\r\n                       type=\"password\"/>\r\n            </n-form-item>\r\n          </n-form>\r\n        </div>\r\n        <n-h3 prefix=\"bar\" type=\"success\">网站基础配置</n-h3>\r\n        <n-form class=\"install-form\" label-placement=\"top\" label-width=\"auto\">\r\n          <n-form-item label=\"网站名称\">\r\n            <n-input v-model:value=\"data.site.name\" placeholder=\"请输入网站名称\"/>\r\n          </n-form-item>\r\n          <n-form-item label=\"网站描述\">\r\n            <n-input v-model:value=\"data.site.desc\" placeholder=\"请输入网站描述\"/>\r\n          </n-form-item>\r\n          <n-form-item label=\"网站关键字\">\r\n            <n-input v-model:value=\"data.site.keywords\" placeholder=\"请输入网站关键字\"/>\r\n          </n-form-item>\r\n          <n-form-item label=\"网站域名\">\r\n            <n-input v-model:value=\"data.site.domain\" placeholder=\"请输入网站域名\"/>\r\n          </n-form-item>\r\n        </n-form>\r\n        <n-h3 prefix=\"bar\" type=\"success\">管理员账号</n-h3>\r\n        <n-form class=\"install-form\" label-placement=\"top\" label-width=\"auto\">\r\n          <n-form-item label=\"管理员账号\">\r\n            <n-input v-model:value=\"data.admin.username\" placeholder=\"请输入管理员账号\"/>\r\n          </n-form-item>\r\n          <n-form-item label=\"管理员昵称\">\r\n            <n-input v-model:value=\"data.admin.nickname\" placeholder=\"请输入管理员昵称\"/>\r\n          </n-form-item>\r\n          <n-form-item label=\"管理员密码\">\r\n            <n-input v-model:value=\"data.admin.password\" placeholder=\"请输入管理员密码\" show-password-on=\"click\"\r\n                     type=\"password\"/>\r\n          </n-form-item>\r\n          <n-form-item label=\"管理员邮箱\">\r\n            <n-input v-model:value=\"data.admin.email\" placeholder=\"请输入管理员邮箱\"/>\r\n          </n-form-item>\r\n        </n-form>\r\n        <div class=\"install-content\" style=\"display: flex;align-items: center;justify-content: flex-end\">\r\n          <n-button style=\"margin-right: 10px\" type=\"info\" @click=\"prev\">上一步</n-button>\r\n          <n-button type=\"primary\" @click=\"startInstall\">开始安装</n-button>\r\n        </div>\r\n      </div>\r\n      <div v-if=\"install.current === 2\">\r\n        <n-h3 prefix=\"bar\" type=\"success\">安装日志</n-h3>\r\n        <n-log ref=\"logInstRef\" :loading=\"install.installLoading\" :log=\"install.log\" :rows=\"20\" language=\"bash\" trim/>\r\n        <div class=\"install-content\" style=\"display: flex;align-items: center;justify-content: flex-end\">\r\n          <n-button style=\"margin-right: 10px\" type=\"info\" @click=\"prev\">上一步</n-button>\r\n          <n-button v-if=\"install.status[install.current] === 'finish'\" type=\"primary\" @click=\"install.current = 3\">\r\n            完成\r\n          </n-button>\r\n        </div>\r\n      </div>\r\n      <div v-if=\"install.current === 3\">\r\n        <n-h3 prefix=\"bar\" type=\"success\">安装完成</n-h3>\r\n        <n-result description=\"安装成功，请登录后台进行设置\" status=\"success\" title=\"安装成功\"/>\r\n        <div class=\"install-content\" style=\"display: flex;align-items: center;justify-content: flex-end\">\r\n          <n-button type=\"primary\" @click=\"router.push({name: 'login'})\">登录</n-button>\r\n        </div>\r\n      </div>\r\n    </n-card>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.install-container {\r\n  padding: 24px;\r\n}\r\n\r\n.install-panel {\r\n  width: 55%;\r\n  margin: 0 auto;\r\n}\r\n\r\n.install-content {\r\n  margin: 20px 0;\r\n}\r\n\r\n.install-steps {\r\n  margin: 20px 0;\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.install-db-engine {\r\n  padding: 20px 24px 10px;\r\n}\r\n\r\n.install-form {\r\n  margin: 0 auto;\r\n  padding: 10px 24px;\r\n}\r\n</style>","import script from \"./Install.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Install.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Install.vue?vue&type=style&index=0&id=33966a7c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-33966a7c\"]])\n\nexport default __exports__"],"names":["router","useRouter","message","useMessage","install","reactive","current","status","log","installLoading","checkConfigData","configCheck","then","res","data","code","push","name","catch","err","mysql","host","port","database","user","password","site","desc","keywords","domain","admin","username","nickname","email","startInstall","next","systemStartInstall","success","error","prev","logInstRef","ref","onMounted","watchEffect","nextTick","value","scrollTo","position","silent","__exports__"],"sourceRoot":""}